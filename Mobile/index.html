<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- NAVBAR -->

    <nav>
      <div class="nav-wrapper blue lighten-2">
        <a href="#" class="brand-logo center">TODOlist</a>
      </div>
    </nav>

    <!-- INPUT BLOCK -->

    <div class="row">
      <div class="input-field col s9">
        <input value="" id="TaskImput" type="text" class="validate" />
        <label class="active" for="first_name2">новая запись</label>
      </div>

      <div class="input-field col s3">
        <a
          class="btn-floating btn-large waves-effect waves-light blue darken-1"
          onclick="createTask()"
          id="addButton"
          ><i class="material-icons">add</i></a
        >
      </div>
    </div>

    <!-- TASK LIST -->

    <ul class="collection with-header" id="TaskListContainer"></ul>

    <!-- <script>
      const TaskListContainer = document.getElementById("TaskListContainer");
      let TaskItems = [];
      let localItems = JSON.parse(localStorage.getItem("items"));
      localItems.forEach((localItem, i) => {
        TaskItems.push(localItem);
      });
      document.addEventListener("DOMContentLoaded", renderList());

      function renderList() {
        let tasksHTML = "";

        TaskItems.forEach((TaskItem, i) => {
          let isComplete = TaskItem.isComplete ? "strikeItem" : "";

          tasksHTML += `
            <li class="collection-item">
                <div><span class ="${isComplete}" onclick="toggInCompleteTask(${TaskItem.id})">${TaskItem.text}</span>
                    <a href="#!" class="secondary-content">

                        <button  btn-small blue darken-1"

                        onclick='editTask(${TaskItem.id})'>
                            <i class="material-icons">border_color</i>
                        </button>

                        <button
                        btn-small blue darken-1"

                        onclick="deleteTask('${TaskItem.id}')">
                            <i class="material-icons" >delete</i>
                        </button>

                    </a>
                </div>
            </li>`;
        });
        TaskListContainer.innerHTML = tasksHTML;
      }
      function createTask() {
        const text = document.getElementById("TaskImput").value;
        if (text) {
          const task = {
            id: "_" + Math.random().toString(36).substr(2, 9),
            text: text,
            isComplete: false,
          };

          TaskItems.push(task);
          saveTasksLocal();
          document.getElementById("TaskImput").value = "";
          renderList();
        } else {
          return;
        }
      }
      document.addEventListener("keydown", function (event) {
        if (event.keyCode === 13) {
          createTask();
        }
      });
      function deleteTask(id) {
        TaskItems.forEach((TaskItem, i) => {
          if (TaskItem.id == id) {
            TaskItems.splice(i, 1);
          }
        });

        saveTasksLocal();
        renderList();
        return;
      }
      function openTaskEditor(i) {
        let container_sayver = TaskListContainer.innerHTML;
        let old_task_text = TaskItems[i].text;
        TaskListContainer.innerHTML = `
        <div class="row">
          <div class="input-field col s9">
            <input value="${old_task_text}" id="EditTaskField" type="text" class="validate" />
            <label class="active" for="first_name2">редактировать запись</label>
          </div>

          <div class="input-field col s3">
            <a
              class="btn-floating btn-large waves-effect waves-light deep-purple lighten-3"
              onclick="editTask(${i})"
              id="editButton"
              ><i class="material-icons">add</i></a
            >
          </div>
        </div>
        `;
        TaskListContainer.innerHTML =
          container_sayver + TaskListContainer.innerHTML;
        return;
      }

      function editTask(i) {
        TaskItems[i].text = document.getElementById("EditTaskField").value;
        saveTasksLocal();
        renderList();
      }
      function strikeTask(i) {
        let bul = !TaskItems[i].isComplete;
        TaskItems[i].isComplete = bul;
        saveTasksLocal();
        renderList();
        return;
      }

      function saveTasksLocal() {
        localStorage.setItem("items", JSON.stringify(TaskItems));
      }
    </script> -->
  </body>
</html>
